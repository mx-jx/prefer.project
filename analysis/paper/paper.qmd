---
title: Preferred medications for opioid agonist therapy and associated factors among people who regularly use opioids in Australia
author:
  - name: MJ Stowe
    orcid: 0000-0002-0760-5497
    corresponding: true
    email: mjstowe@kirby.unsw.edu.au
    roles:
      - Investigation
      - Project administration
      - Software
      - Visualization
    affiliations:
      - The Kirby Institute, UNSW Syndey, Sydney Australia
  - name: Anna Conway
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - The Kirby Institute, UNSW Syndey, Sydney Australia
  - name: Frederick Altice
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - Yale School of Medicine, Yale University, New Haven, Connecticut, United States
  - name: Tom Hassett
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - Yale School of Medicine, Yale University, New Haven, Connecticut, United States
  - name: Marianne Byrne
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - The National Drug and Alcohol Research Centre, UNSW Syndey, Sydney, Australia
      - The Kirby Institute, UNSW Syndey, Sydney Australia
  - name: Samantha Colledge
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - The National Drug and Alcohol Research Centre, UNSW Syndey, Sydney, Australia
  - name: Phillip Read
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - Kirketon Road Centre, Sydney, New South Wales, Australia 
      - Drug and Alcohol Services, Northern Sydney Local Health District, Sydney, New South Wales, Australia
  - name: Mark Montebello
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - The National Drug and Alcohol Research Centre, UNSW Sydney, UNSW, Australia
      - Drug and Alcohol Services, Northern Sydney Local Health District, Sydney, New South Wales, Australia
      - University of Sydney, Sydney, New South Wales, Australia
  - name: Jeremy Hayllar
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - Drug Health Service, South West Sydney Local Health District, New South Wales, Australia
  - name: Sione Crawford
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - Harm Reduction Victoria, Victoria, Australia
  - name: Charles Henderson
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - New South Wales Users and AIDS Association (NUAA), Sydney, Australia
  - name: Michael Farrell
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - The National Drug and Alcohol Research Centre, UNSW Sydney, Sydney, Australia
  - name: Chris Gough
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - CAHMA
  - name: Louisa Degenhardt
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - The National Drug and Alcohol Research Centre, UNSW Syndey, Sydney, Australia
  - name: Amy Peacock
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - The National Drug and Alcohol Research Centre, UNSW Syndey, Sydney, Australia
  - name: Gregory J. Dore
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - The Kirby Institute, UNSW Syndey, Sydney Australia
  - name: Jason Grebely
    orcid: 0000-0002-7859-8394
    corresponding: false
    roles: []
    affiliations:
      - The Kirby Institute, UNSW Syndey, Sydney Australia
title-block-published: "Last updated"  
date: now
date-format: long
format:
  html: default
  docx:
    reference-doc: "../templates/template.docx" # Insert path for the DOCX file
execute:
  echo: true
  warning: false
  message: false
  comment: "#>"
  fig-path: "../figures/"
  fig-dpi: 600
filters:
  - ../templates/scholarly-metadata.lua
  - ../templates/author-info-blocks.lua
  - ../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style
keywords:
  - Opioid agonist therapy
  - Medications for opioid use disorder
  - Methadone
  - Burpenorphine
abstract: |                                                                                          
  **Background:** Opioid agonist therapy (OAT) is effective in mitigating adverse outcomes, with individual preference identified as key to enhancing treatment. We examined OAT preferences and associated factors in a national sample of people who regularly use opioids. **Methods:** In this cross-sectional study, 400 people were enrolled between October 2020-April 2021. Participants completed an interviewer-administered questionnaire with questions on sociodemographic, behavioural, drug use- and treatment-related characteristics. Multivariable logistic regression was used to evaluate factors associated with preference for methadone. **Results:**Among all participants (mean age 45, 42% female), 91% (n=352) preferred a particular type of OAT. Among those who reported a preference for OAT, 61% (n=216) preferred methadone, while 39% (n=136) preferred buprenorphine. Among those preferring buprenorphine (n=136), 50% (n=68) had a preference for sublingual/oral buprenorphine and 50%(n=68) had a preference for long-acting buprenorphine. Heroin (aOR 1.78, 95%CI:1.06, 3.00) and non-prescribed pharmaceutical opioid use in the past month (aOR 2.23, 95%CI:1.07, 4.95), and ever receiving OAT with methadone (aOR 6.54, 95%CI:2.66, 17.91) was associated with increased odds of a preference for methadone, while, ever receiving OAT with buprenorphine was associated with decreased odds of a preference for methadone (aOR 0.19, 95%CI:0.10, 0.35). Among participants currently on treatment with a preference for OAT (n=301), 77% (n=180) of those receiving methadone (n=235) and 92% (n=61) of those receiving buprenorphine (n=66) were prescribed their preferred medication. **Conclusions:** Among people who regularly used opioids, two-thirds preferred to receive methadone and of those preferring buprenorphine, around half indicated a preference for long-acting buprenorphine. The majority of those currently receiving OAT were prescribed their preferred medication, with past month heroin and pharmaceutical opioid use, extramedical and prescribed methadone use associated with increased odds of a preference for methadone. 

plain-language-summary: |
  In a national sample of people who regularly use opioids, most preferred OAT with methadone. These participants were more likely to have ever received methadone, and have previously used heroin or non-prescrived pharmaceuticals. Among participants currently receiving OAT, almost all were receiving their preferred therapy.
key-points: |
  - From our sample of people who regularly use opioids from around Australia. most preferred to receive opioid agonist therapy with methadone.
  - Current OAT participants (n=317) comprised 78% (n=x) on methadone and 91% (n=x) on buprenorphine, with 78% (n=x) and 91% (n=x) receiving their preferred medication reservoirs.

---

<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->

<!-- With the following code you can access and display values from the yml header above. -->

Keywords: `r rmarkdown::metadata$keywords`

Highlights: `r rmarkdown::metadata$highlights`

<!-- The actual document text starts here: -->

# Introduction

People who use opioids from the unregulated market are increasingly exposed to related social and health harms (Milaney et al. 2022; Cheetham et al. 2022), including fatal and non-fatal opioid-involved overdose (Santo et al. 2021; Åstrøm et al. 2023), incarceration (Gisev et al. 2019; Fazel, Yoon, and Hayes 2017), stigma (Treloar et al. 2022) and structural violence (Lancaster et al. 2023). Use via injection is associated with health risks (Brener et al. 2022; Colledge et al. 2019; Degenhardt et al. 2019) such as increased risk of HIV and HCV infection (Grebely et al. 2022; Martinello et al. 2017; Hajarizadeh et al., n.d.), skin and soft tissue infection (Wheeler et al. 2022) and endocarditis (Wurcel et al. 2016; See et al. 2020). Opioid agonist therapy (OAT) with methadone and buprenorphine is effective in reducing associated harms (Degenhardt et al. 2023; Nielsen et al. 2016; Nielsen, Tse, and Larance 2022; Jones et al. 2022), with retention associated with improved social and health outcomes , and reduced quality-adjusted life-years lost compared to no treatment or non-pharmacological interventions (Martin et al. 2022). Despite the efficacy of these medications (Degenhardt et al. 2023), treatment acceptability, satisfaction, and retention is sub-optimal, globally. 

Individual preferences for OAT medications play a pivotal role in determining positive treatment outcomes (Joosten et al. 2008). With similar outcomes for a range of measures among particular subgroups between medications (Degenhardt et al. 2023), the choice between methadone and buprenorphine should be informed by consultation with each person after consideration of preferences and the relative risks and benefits of each medication to the individual. While a number of studies explore the role of treatment preferences generally (Uebelacker et al. 2016; Kenney et al. 2018), relatively fewer numbers of studies focus specifically on factors associated with preferences for medication types and formulations.

Preferences for OAT and individual choice are identified as key to improving treatment outcomes and reducing potential harms associated with use of unregulated opioids (Muthulingam et al. 2023). Preferences are comprised of attitudes, beliefs, expectations, values, and processes used to evaluate the costs and benefits of treatment options (Montori, Brito, and Murad 2013), with the decision for one formulation over another being largely preference sensitive (Keirns and Goold 2009). Understanding treatment preference could inform shared decision-making and help to overcome barriers to effective, person-centred healthcare and support (Madden et al. 2008). However, little is known about how medication preferences and previous experiences influence treatment decisions among people who regularly use opioids.

Preferences, perceptions, and acceptability of medication formulations vary widely based on each participant’s individual experiences, goals, and values (Neale et al. 2018; Neale, Parkin, and Strang 2023; Neale, Tompkins, and Strang 2019a). Previous studies exploring preferences for methadone and buprenorphine have compared client preferences of methadone with buprenorphine (Hill et al. 2015). However, findings have been inconsistent and variable (White et al. 2007), with some studies finding that participants preferred methadone over buprenorphine, whereas others have found the opposite. Previous studies into treatment preferences carried out in the United Kingdom (Neale et al. 2018; Tompkins, Neale, and Strang 2019), France (Rolland et al. 2021), North America (Saunders et al. 2020; Muthulingam et al. 2023; Kaplowitz et al. 2022a), Iran (Amini-Rarani, Moeeni, and Ponnet 2023) and Australia (Larance et al. 2020) suggest that preferences for OAT is influenced by a range of physical, psychological and social factors. Additional studies have explored preferences generally, however, understanding of factors that influence and contribute to stated preference are limited. Limitations of previous studies include limited geographic scope with samples from single clinics [e.g. Bailey, Herman, and Stein (2013)] or cities [e.g. Luty (2004)], and relatively small samples and subsequent lack of power to investigate factors associated with OAT preferences [e.g. (Ridge et al. (2009)], with there being only a few studies from Australia (Larance et al., 2019), the US (Saunders et al.,2020) and France (Rolland et al. 2019) that have quantitatively assessed preferences for long-acting injectable buprenorphine among people who regularly use opioids.  

Accessibility and diversity of OAT need to be enhanced to ensure that all people can receive their preferred OAT. Improved understanding of preference and factors associated with a preference for OAT preference is needed to inform policy and service provision. Extensive literature on patient participation in medication decision-making emphasizes that incorporating patient treatment preference leads to higher rates of retention and the desired outcomes (Friedrichs et al. 2016; Joosten et al. 2008). Information on OAT preference has shown to enhance patient acceptability, leading to increased OAT treatment uptake, adherence, and retention to improve clinical utility and facilitate planning, prioritization and investment in national strategies and guidelines (Joosten et al. 2008). Providers incorporating client preferences into treatment is linked to increased satisfaction, with individual choice, with alignment with preferred therapy leading to improved outcomes (Fallah 2015). 

To better understand treatment preferences and develop an evidence-base to inform policy and treatment service design and delivery, we examined OAT preferences and associated factors among a national sample of people who regularly use opioids in Australia.

Here is a citation [@Marwick2017]

# Background

# Methods

## Study design and participants

In this cross-sectional study, participants were enrolled from 59 sites including drug and alcohol treatment clinics (n=28), needle and syringe programmes (n=13), pharmacies (n=5) and organisations advocating for (n=6) and providing support and services to people who use drugs (n=7). There was national representation of sites across all states and territories in Australia (except Tasmania), including Australian Capital Territory (n=3), New South Wales (n=37), the Northern Territory (n=1), Queensland (n=9), South Australia (n=6), Victoria (n=2), and Western Australia (n=1). Study enrolment took place between October 2020 and April 2021 and continued throughout periods of COVID-19-related restrictions. To be eligible for this study, participants had to be aged 18 years or older, provide voluntary and informed consent, and use opioids regularly. In this study, regular opioid use was defined as use of any opioid (including heroin, methadone, buprenorphine, any other opioid use, or the extramedical use of pharmaceutical opioids) on at least 21 of the past 28 days. 

## Procedures 

Participants were recruited from a range of settings (including drug and alcohol treatment services, needle and syringe programmes, organisations providing support and services for people who use drugs, community-based and -led advocacy organisations, and pharmacies), via snowballing (where eligible participants promote the study via their personal networks), and word-of-mouth. The study was advertised at services using posters and fliers, but service staff were not directly involved in recruitment. Participants who were interested in the study contacted the study team directly and were screened for eligibility over the telephone.

Interviewers contacted the person over the phone or video conference (Microsoft Teams or Zoom) to obtain consent and conduct the interview. Interviews were semi-structured were conducted by trained interviewers. Participants completed an interviewer-administered questionnaire focused on patient preferences for OAT that included information on participant demographics, drug use characteristics, and drug treatment. The interviews took approximately 30-45 minutes to complete, and participants were reimbursed AUD$40 for their time and out-of-pocket expenses.

## Outcomes

The primary outcome was a preference for opioid agonist therapy with methadone, which was assessed by asking the question “Of all the following types of medications used for opioid agonist therapy, if you could choose today, which one would you prefer?” Options included methadone, buprenorphine (Subutex), buprenorphine-naloxone (Suboxone) taken orally as a film or tablet, long-acting injectable buprenorphine (Buvidal or Sublocade), any treatment (i.e., no preference for any medication), and no treatment.

Demographic, behavioural, and clinically significant factors hypothesised to be associated with preference to receive OAT with methadone were determined a priori, comprising the following: age at survey (18 - 35; 36 – 45; > 45 years old), gender (female; male; transgender), education (< year 10; >year 10), employment (paid; other), homelessness, chronic pain, incarceration history (never, >6 months ago, >6 months ago), Drugs used and injected in the last 28 days (heroin, non-prescribed methadone, non-prescribed buprenorphine, other pharmaceutical opioids, methamphetamine, cocaine and benzodiazepines), frequency of injection drug use (>1 year ago, within 1–12 months ago, within the last month less than daily, and daily or more), OAT (history and current), with methadone (history and current) and buprenorphine (history and current). Among the sub-group of participants currently receiving OAT, factors hypothesized to be associated with a preference for OAT with methadone included current OAT medication (methadone; buprenorphine; buprenorphine-naloxone; long-acting injectable buprenorphine; none), drugs used while on OAT (heroin, non-prescribed methadone, non-prescribed buprenorphine, other pharmaceutical opioids, methamphetamine, cocaine and benzodiazepines); payment of out of pocket for OAT treatment; amount paid out of pocket for OAT (0 AUD; 1 - 99 AUD; 100 - 149 AUD; 150 - 399 AUD), site last prescribed OAT medication was collected (pharmacy; public clinic; private clinic; at home; other), frequency of OAT dose collection (daily or several times per week; weekly or less frequently), distance travelled to OAT collection site, number of days where a dose was missed (None; 1 - 5 days; > 5 days) and time travelled to OAT collection site (less than 30 minutes; more than 30 minutes).

## Statistical analysis

The proportion of people who reported preference for methadone and factors associated with this preference was assessed using logistic regression modelling. The final sample included those who chose a preference for treatment with either methadone or any buprenorphine formulation (n=352). Multivariable logistic regression was used assess factors associated with preferred OAT medication. Unadjusted and adjusted odds ratios were derived using logistic regression and 95% confidence intervals calculated for all variables. For the final model, all the explanatory variables significantly associated with the outcome in the bivariate models were included in the multivariable model, whilst also adjusting for age and gender. The final model was assessed through examining which contributed significantly to model fit through backwards selection using decreasing values of Akaike Information Criterion. The variance inflation factor was used to assess collinearity in the final model (O’brien 2007). Individuals with missing values were not integrated in the models. A subset of the sample comprising of participants currently receiving OAT with methadone and buprenorphine (including sublingual buprenorphine, buprenorphine-naloxone and long-acting injectable buprenorphine) was selected for analysis. 

The analytical approach received input from and was reviewed by people who use opioids with lived-experience of injecting drug use and OAT with various formulations of methadone and buprenorphine. Advice and perspectives were provided on the inclusion of explanatory variables and the clinical and practical significance of identified factors.

The analysis was undertaken in R version 4.2.2 using the gtsummary v. 1.7.2 (Sjoberg et al. 2021; bivariate and multivariable logistic regression) and performance v. 0.10.8 (Lüdecke et al. 2021; assessment of multicollinearity) packages.

## Study oversight
All participants provided written informed consent before study procedures. The study protocol and amendments were approved by the Human Research Ethics Committees at St Vincent’s Hospital, Sydney (HREC Ref: HREC/17/SVH/113) and the Aboriginal Health and Medical Research Council (HREC Ref: 1279/17). This study was conducted according to the Declaration of Helsinki and International Conference on Harmonization Good Clinical Practice (ICH/GCP) guidelines.

## Role of the Funding source

The study was funded by research grants from the National Health and Medical Research Council. The funders had no role in the study design, data collection, analysis, interpretation of the results, writing or the decision to submit the study for publication. JG, AC, LD, and MJS had access to the raw data. The National Drug and Alcohol Research Centre and the Kirby Institute, UNSW collaborated to design the study, monitor study conduct, and perform the statistical analysis. JG and LD were responsible for the decision to submit the study for publication.

# Results

Participant characteristics
Overall, 400 participants were enrolled (Figure 1). The median age was 45 years, 41% (n=162) were female, 48% (n=193) incarcerated in the last six months and 42% (n=169) were currently living with chronic pain (Table 1).

At enrolment, 78% (n=310) had injected drugs in the previous month, with 45% (n=141) having injected drugs >daily. Most participants had previously received OAT (n = 344; 87%), with 91% (n=319) and 87% (n=344) previously having received methadone and buprenorphine, respectively (Table 1). Among those who injected in the previous month (n=310), commonly injected drugs included heroin (87%), methamphetamine (46%), other non-prescribed pharmaceutical opioids (14%),  non-prescribed methadone (13%), non-prescribed buprenorphine (10%), cocaine (9%) and benzodiazepines (1%)

Among participants currently receiving OAT, 77% (n=243) were prescribed methadone, 15% (n=47) buprenorphine-naloxone (Suboxone), 6% (n=18) long-acting injectable buprenorphine (Buvidal or Sublocade), 3% (n=9) buprenorphine (Subutex) and 2% (n=5) were not in treatment. Among those receiving treatment, most collected their last dose at pharmacies (n=150; 47%) or public clinics (n=111; 35%), with just over half (n=177; 56%) travelling less than five kilometres to receive their medication (Table 2).

# Preferences for OAT 
Among all participants (n=400), 92% (n=366) indicated a preference for receiving OAT, including 88% (n=352) preferring either methadone or any formulation of buprenorphine and 4% (n=14) choosing treatment, but having no preferred medication. Among those indicating a preference for 
a particular OAT (n=352), methadone was preferred by 61% (n=216) and buprenorphine by 39% (n=136). Among those who preferred buprenorphine, sublingual buprenorphine-naloxone was preferred by 50% (n=68) and long-acting injectable buprenorphine by 50% (n=68). A summary of sociodemographic characteristics stratified by OAT preference is presented in Table 1. 

Among participants currently receiving OAT (n=313), 95% (n=296) preferred either oral methadone or any formulation of buprenorphine, 2% (n=5) would choose treatment, but had no preferred OAT and 4% (n=12) would prefer not to receive treatment. Methadone was preferred by 60% (n=185), oral/sublingual buprenorphine by 18% (n=56) and long-acting injectable buprenorphine by 18% (n=55). 

Of those receiving OAT with a preference for a particular treatment (n=296), 79% (n=235) were currently prescribed methadone and 22% (n=66) buprenorphine (including oral or sublingual buprenorphine, buprenorphine-naloxone, and long-acting injectable buprenorphine). Among participants currently prescribed methadone, 77% (n=180) preferred methadone. Of those prescribed any formulation of buprenorphine, 92% (n=61) preferred buprenorphine. A summary of sociodemographic characteristics of people currently receiving OAT stratified by preference is presented in Table 2.

## Factors associated with preference for methadone

In adjusted analyses, factors associated with an increased odds of preference for methadone included heroin use [adjusted odds ratio (aOR), 1.78 95% CI:1.06, 3.00)] and other pharmaceutical opioid use (aOR 2.23, 95% CI:1.07, 4.95) in the last month and ever having received OAT with methadone (aOR 6.54, 95% CI:2.66, 17.91)(Figure 2). Factors associated with decreased odds of preference for methadone included OAT with buprenorphine (aOR 0.19, 95% CI:0.10, 0.35) and non-prescribed buprenorphine use in the past month (aOR 0.28, 95% CI:0.09, 0.84) (Figure 2). 

In adjusted analyses among participants currently receiving OAT, current receipt of OAT with buprenorphine was associated with a decreased odds of preference for methadone (aOR 0.03, 95%CI:0.01, 0.06) (Figure 3). 

<!-- Here's some example analysis code: -->

```{r}
#| label: get-data
#| eval: false
# Note the path that we need to use to access our data files when rendering this document
my_data <- read.csv(here::here('analysis/data/raw_data/my_csv_file.csv'))
```

```{r}
#| label: fig-demo-plot
#| fig-cap: "A plot of random numbers"
plot(rnorm(10))
```

@fig-demo-plot shows how we can have a caption and cross-reference for a plot. Note that figure label and cross-references must both be prefixed with `fig-`

```{r}
#| label: demo-inline-code
#| echo: false
x <- round(pi, 2)
```

Here is an example of inline code `r x` in the middle of a sentence.

# Discussion

This study evaluated preferences for OAT among a national sample of people with who regularly use opioids in Australia. Overall, 91% demonstrated a preference for OAT, with 54% preferring methadone and 34% preferring buprenorphine. Among those with a preference for buprenorphine, half indicated a preference for long-acting injectable buprenorphine. Among those prescribed OAT, 77% of those receiving methadone and 92% of those receiving buprenorphine had a preference for the medication they were receiving. Factors associated with increased odds of a preference for methadone included recent use of heroin and other pharmaceutical opioids and ever having received methadone. Factors associated with decreased odds of a preference for methadone included ever having received OAT with buprenorphine. This study provides important insights into the factors associated with preferred OAT and offers guidance in clinical decision making for the management and mitigation of drug-related risks among people who regularly use opioids.

Most participants preferred OAT. This is consistent with other studies (Bailey, Herman, and Stein 2013; Uebelacker et al. 2016) who found that among people in opioid withdrawal management, 63% - 78% would choose OAT following withdrawal. The 9% (n=34) who had a preference for no treatment in this study is less than other studies, where 22% (n=82/372) of participants undergoing inpatient detox (Bailey et al. 2013) and one third (n=12/40) of opioid-dependent people   preferred not to receive OAT (Saunders et al. 2020). The choice of whether to choose OAT is based on several individual and structural-level factors. In Australia, treatment programs in the public sector are characterised by daily supervised dosing, out-of-pocket costs, and small windows in which doses of daily medication can be dispensed (Hall et al. 2023; Komalasari, Wilson, and Haw 2021). Those choosing to not receive OAT often list the onerous requirements of daily supervised dosing as too demanding (Crawford 2013), experiences of stigma, discrimination and structural violence associated with treatment (Treloar et al. 2022), perceptions of replacing one drug for another (Frank 2020), distrust in the motives of pharmaceutical companies and prescribers (Saunders et al. 2020), and misalignment with personal pursuits of well-being, bodily autonomy and positive treatment outcomes (Mayock and Butler 2021; Carlisle et al. 2023) as reasons for not choosing to enrol on or discontinue treatment (Clay et al. 2023).

A larger proportion of participants preferred methadone over formulations of buprenorphine. This finding is consistent with other studies, including (Pinto et al. 2010) where among 361 opioid-dependent individuals, 63% (n=227) patients chose methadone and 37% (n=134) buprenorphine. However, in contrast, (Uebelacker et al. 2016), in a study of people in opioid withdrawal management, found that more people preferred buprenorphine over methadone following withdrawal, with 18% (n=68) stating a preference for methadone, 28% (n=104) buprenorphine and 32% (n=118) extended-release naltrexone (which is currently not registered for the management of opioid use in Australia). These inconsistent findings have been noted by others (Neale et al. 2018; Rolland et al. 2021; Neale, Tompkins, and Strang 2019b). Individual preferences for treatment with these medications are multifaceted and influenced by perceived effectiveness, privacy concerns, autonomy, convenience, previous treatment experiences, and side effect profiles.

Among those with a preference for buprenorphine, an equal number of participants preferred short-acting buprenorphine (oral or sublingual buprenorphine and buprenorphine-naloxone) as long-acting injectable buprenorphine. A previous study by (Kenney et al. 2018) in the United States found that 55% of people stated they preferred buprenorphine over other formulations and of these, 49% preferred daily oral formulations and 23% preferred a weekly or monthly buprenorphine dose of long-acting injectable injection. 

Participants who had previous experience with receiving methadone were more likely to prefer methadone, consistent with several studies that identify prior treatment experience are a strong predictor of treatment preference. Elsewhere, factors associated with a preference for buprenorphine include negative past experiences with methadone (Yarborough et al. 2016) and positive outcomes with buprenorphine (Ridge et al., 2009) (Yarborough et al. 2016). Among opioid-dependent people seeking OAT, the odds of being prescribed buprenorphine were three times greater among those reporting a preference for it; similarly, the odds of receiving methadone were twice as great among those requesting methadone (Ridge et al. 2009). Research demonstrates that client preference for buprenorphine and methadone varies, and is influenced by peer attitudes, prior treatment experience, and clinic dispensing practices  (Pinto et al. 2010; Gryczynski et al. 2013). 

Among participants currently receiving OAT, most were receiving their preferred therapy, with 77% and 92% in receipt of methadone and buprenorphine, respectively, reporting a preference for the current medication. Limited studies have investigated treatment outcomes associated with receipt of preferred therapy, however, extensive literature on client participation in medication decision making demonstrates that incorporating client preference leads to higher rates of retention and related positive outcomes (Fallah 2015; Friedrichs et al. 2016; Gilman et al. 2018; Gryczynski et al. 2013; Joosten et al. 2008). Currently, available formulations in Australia exclude several formulations and modes of delivery that are available in other countries. For example, injectable opioid agonist therapy (iOAT) with hydromorphone or diamorphine has shown promise as a treatment for those who have not experienced the desired outcomes with traditional therapies treatments (reference). Despite not currently an option in Australia, a clinical trial investigating iOAT with hydromorphone is currently underway. Further, Nielsen (Nielsen et al. 2021) found that in a sample of people who regularly use opioids in Australia, 53% of participants (n = 182) stated that they would have a preference for iOAT if available. In addition to the existing evidence-base, further research into medication preferences is needed as the range of available treatments becomes established and up-scaled.

There are several limitations of the study to consider. Data comprising the study arise from cross sectional survey design and convenience sampling of harm reduction sites and voluntary participation of individuals within those sites, therefore these findings may not be generalizable to all people who use drugs. Study sites did not routinely collect information about numbers examined for eligibility, confirmed eligible and included in the study, and we are unable to report these details. However, the demographic characteristics of the current study’s sample are consistent with those of other large Australian studies of people who are regularly use opioids (i.e. the majority male, typically aged early 40s, with the majority of OAT clients receiving methadone) [e.g. (Brener et al. 2022; Larance et al. 2020; Madden et al. 2008)]. Most of the sample were treatment experienced having ever received treatment with methadone or buprenorphine and therefore, there was limited input from participants who had never previously sought treatment. Despite this, there is still a need to ensure that those currently receiving OAT are prescribed their preferred medication, and to understand preferences of those interested in OAT to enhance treatment and improve overall satisfaction. In addition, although most participants preferred treatment with a particular medication (XX%), the sample of participants preferring sublingual buprenorphine (n=68) and long-acting injectable buprenorphine (n=68) was relatively small, limiting the statistical power to detect differences and representativeness. A larger and more diverse sample would enhance the study’s reliability and enable more robust analysis. The survey’s self-report nature may introduce bias, as participants’ preferences might not fully align with their actual experiences with these medications. In addition, this study was conducted prior to the widespread implementation of long-acting injectable formulations of buprenorphine and participants were therefore largely unfamiliar to people receiving OAT. The lack of familiarity with these formulations is a potential source of bias as participants were reporting on hypothetical scenarios and anticipated preferences, benefits and disadvantages. This study adds to the evidence-base by building on previous research with smaller sample sizes from single cities or recruitment sites (Bailey, Herman, and Stein 2013; Ridge et al. 2009; Pinto et al. 2010), within restricted settings and populations (Kaplowitz et al. 2022b) and enhances understanding of a wider range of factors associated with OAT identified by others (Muthulingam et al. 2023). Despite these limitations, this study provides important insights into experiences of those currently receiving OAT and the desirability of various options. 

The findings from this study have important clinical and policy implications. Evidence suggests that treatment outcomes are suboptimal, globally (Degenhardt et al. 2023). To enhance OAT outcomes, interventions must include individual preference and choice (along with shared decision-making). It is critical to better understand patient preferences for different OAT medications in different settings and that this might vary by the context in different countries and that further work is needed globally to better understand patient preferences for different OAT medications in different countries. While many of the state-based OAT guidelines recommend that the choice between methadone or buprenorphine should be made in consultation with the client, and informed by the client’s preference, many feel that the recent push to up-scale long-acting injectable buprenorphine infringe on the guidelines. Findings from this study could be used to guide the development of less punitive ways of delivering methadone, such as increased availability of flexible dosing times and take-away doses, that have been found in observational studies to improve treatment outcomes (Gomes et al. 2022; Ward et al. 2022). 

CONCLUSION
In conclusion, this study provides valuable insight into opioid agonist therapy preferences among people who regularly use opioids. Methadone was preferred over any available formulation of buprenorphine by most participants, where a similar number of participants preferred oral or sublingual and long-acting injectable formulations of buprenorphine. Most those receiving treatment were prescribed their preferred medication, with previous and current treatment experience the strongest predictor of medication preference. Australian OAT guidelines recommend that client preferences are considered in choosing medications. These findings may act as a guide for those discussions that are had on an individual basis. Clinical decision making around treatment options must centre individual preference and balance suitability and choice of treatment.

# Conclusion

In conclusion, this study provides valuable insight into opioid agonist therapy preferences among people who regularly use opioids. Methadone was preferred over any available formulation of buprenorphine by most participants, where a similar number of participants preferred oral or sublingual and long-acting injectable formulations of buprenorphine. Most those receiving treatment were prescribed their preferred medication, with previous and current treatment experience the strongest predictor of medication preference. Australian OAT guidelines recommend that client preferences are considered in choosing medications. These findings may act as a guide for those discussions that are had on an individual basis. Clinical decision making around treatment options must centre individual preference and balance suitability and choice of treatment.

# Acknowledgements

<!-- The following line inserts a page break  -->

\newpage

# References

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

::: {#refs}
:::

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies:

```{r}
#| label: colophon
#| cache: false

# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```




## Supplementary Material {#sec-supp-material}

### Table S1

```{r}

pts_subset_stratified <-  
  p %>% 
  tbl_summary(by = oatpref.all, include = c(age,agegroup, genderall.factor, edu.factor, 
                                              
                                              income.factor.yn, homeless.factor.yn,         
                                              prison.factor, chronicpain.factor.yn, 
                                              heroin.month.factor,  
                                              nonmethadone.month.factor,
                                              nonbupe.month.factor,  
                                              otheropi.month.factor, 
                                              cocaine.month.factor, 
                                              meth.month.factor, benzo.month.factor,
                                              anyinject.yn.f,
                                              injfreq.factor, injectingheroin.month.f,
                                              injectingnonmethadone.month.f, 
                                              injectingnonsuboxone.month.f,
                                              injectjngcocaine.month.f,
                                              injectingmeth.month.f,
                                              methadoneever.yn, bupeever.factor
                                              ),
  # type = all_categorical() ~ "categorical",
  label = 
    list(age ~ "Age",
         agegroup ~ "Age group",
         # usedrugs.oat ~ "Drugs used while on OAT",
         methadoneever.yn ~ "Ever received OAT with methadone", 
         bupeever.factor ~ "Ever received OAT with buprenorphine",
         injectingheroin.month.f ~ "Heroin injecting",
         injectingnonmethadone.month.f ~ "Non-prescribed methadone injecting",
         otheropi.month.factor ~ "Non-prescribed pharmaceutical opioid use",
         injectjngcocaine.month.f ~ "Cocaine injecting",
         injectingmeth.month.f ~ "Methamphetamine injecting"
         ), 
         # currentmed ~ "Current OAT medication"),
  type = all_categorical()~"categorical",
  missing = "no",
  percent = "row",
  statistic =(all_continuous()  ~ "{median} ({p25} - {p75})"))%>%
  add_stat_label()%>%
  add_overall(statistic = list(all_continuous()  ~ "{median} ({p25} - {p75})",
                               all_categorical() ~ "{n}")) %>% 
  modify_footnote(update = everything() ~ NA, abbreviation = FALSE) %>%
  modify_header(
    stat_0 = '**Overall** \n **(n = {n})**',
    stat_1 = '**Methadone** \n **(n = {n})**',
    stat_2 = '**Buprenorphine oral** \n **(n = {n})**', 
    stat_3 = '**Buprenorphine LAIB** \n **(n = {n})**', 
    stat_4 = '**Any** \n **(n = {n})**', 
    stat_5 = '**None** \n **(n = {n})**'
  ) %>%
  bold_labels()

pts_subset_stratified.kable  <- pts_subset_stratified  %>%
   gtsummary::as_kable_extra(
    format = "html",
    booktabs = TRUE,
    longtable = TRUE,
    linesep = "", 
    caption="Final model including crude odds ratios (cOR) and adjusted odds ratios (aOR)")%>%
  kableExtra::kable_styling(
      position = "left",
      latex_options = c("striped", "repeat_header"),
      stripe_color = "gray!15"
    )
#     scroll_box(
#   height = "100%",
#   width = "100%",
#   box_css = "border: 1px solid #ddd; padding: 5px; ",
#   extra_css = NULL,
#   fixed_thead = TRUE
# )

pts_subset_stratified.kable 

```

```{r, echo = FALSE, include = TRUE}
#| label: tbl-s1

pts_subset_stratified.kable
```

### Table S2

```{r}
# oat <- p %>%
#   filter(oat.yn.f == "Yes")%>% # By filtering for oat.yn.f = "yes" we are selecting on those participants currently receiving OAT
#   dplyr::select(age, agegroup, edu.factor ,genderall.factor, gender.mf,
#                 income.factor.yn, homeless.factor.yn, homeless.factor,        
#                 prison.factor, chronicpain.factor.yn, prefer.factor,
#                 heroin.month.factor, prescribedmethadone.month.f, 
#                 nonmethadone.month.factor, prescribedsuboxone.month.f,
#                 nonbupe.month.factor, prescribedsuboxone.month.f, otheropi.month.factor, 
#                 cocaine.month.factor, meth.month.factor, benzo.month.factor, 
#                 anyinject.yn.f,otheropi1month,
#                 injfreq.factor, injectingheroin.month.f,
#                 injectingnonmethadone.month.f, 
#                 injectingprescribedmethadone.month.f,
#                 injectingprescribedsuboxone.month.f, 
#                 injectingnonsuboxone.month.f, injectjngcocaine.month.f,
#                 injectingmeth.month.f, injectingbenzo.month.f, methadoneever.yn, 
#                 bupeever.factor, oatcurrentmed.f, usedrugs.oat, paytx.yn.f, 
#                 paytx.factor.month,doselocation.factor, dose.km.factor, 
#                 timedose.factor, oatpref.all, kmdose, dosesite.sep1.factor, 
#                 clinic.attend.factor, lastdosesite, missd.month, missdose.factor, currentmed)
```

```{r}

pts_oatfull_stratified <-  
    p %>%
  filter(lastdosesite != "Not prescribed")%>%
   filter(prefertreat.yn == "Prefers treatment")%>%
  # filter(prefer.factor == "Methadone" | prefer.factor == "Buprenorphine")%>%
  # filter(pref_oat == "Methadone" | prefer.factor == "Buprenorphine")%>%
  filter(oat.yn.f == "Yes")%>%
  tbl_summary(by = oatpref.all, include = c(age,agegroup, genderall.factor, edu.factor, 
                                              
                                              income.factor.yn, homeless.factor.yn,         
                                              prison.factor, chronicpain.factor.yn, 
                                              heroin.month.factor,  
                                              nonmethadone.month.factor,
                                              nonbupe.month.factor,  
                                              otheropi.month.factor, 
                                              cocaine.month.factor, 
                                              meth.month.factor, benzo.month.factor,
                                              anyinject.yn.f,
                                              injfreq.factor, injectingheroin.month.f,
                                              injectingnonmethadone.month.f, 
                                              injectingnonsuboxone.month.f,
                                            injectingnonopi.month,
                                              injectjngcocaine.month.f,
                                              injectingmeth.month.f,
                                              methadoneever.yn, bupeever.factor,
                                              oatcurrentmed.f, usedrugs.oat, missdose.factor, paytx.yn.f, 
                                              lastdosesite,clinic.attend.factor,  
                                              kmdose, timedose.factor, oatpref.all),
  # type = all_categorical() ~ "categorical",
  label = 
    list(age ~ "Age",
         agegroup ~ "Age group",
         usedrugs.oat ~ "Drugs used while on OAT",
         methadoneever.yn ~ "Ever received OAT with methadone", 
         bupeever.factor ~ "Ever received OAT with buprenorphine",
         timedose.factor ~ "Travel time to dosing site",
         clinic.attend.factor ~ "Frequency of OAT dose collection",
         kmdose ~ "Travel distance to OAT collection site (km)", 
         injectingheroin.month.f ~ "Heroin injecting",
         injectingnonmethadone.month.f ~ "Non-prescribed methadone injecting",
         otheropi.month.factor ~ "Non-prescribed pharmaceutical opioid use",
         injectjngcocaine.month.f ~ "Cocaine injecting",
         injectingmeth.month.f ~ "Methamphetamine injecting",
         injectingnonopi.month ~ "Non-prescribed pharmaceutical opioid injecting",
         injectingnonsuboxone.month.f ~ "Non-precsribed buprenorphine injecting",
         lastdosesite ~ "Site last dose collected"), 
         # currentmed ~ "Current OAT medication"),
  type = all_categorical()~"categorical",
  missing = "no",
  percent = "row",
  statistic =(all_continuous()  ~ "{median} ({p25} - {p75})"))%>%
  add_stat_label()%>%
  add_overall(statistic = list(all_continuous()  ~ "{median} ({p25} - {p75})",
                               all_categorical() ~ "{n}")) %>% 
  modify_footnote(update = everything() ~ NA, abbreviation = FALSE) %>%
  modify_header(
    stat_0 = '**Overall** \n **(n = {n})**',
    stat_1 = '**Methadone** \n **(n = {n})**',
    stat_2 = '**Buprenorphine oral** \n **(n = {n})**', 
    stat_3 = '**Buprenorphine LAIB** \n **(n = {n})**', 
    stat_4 = '**Any** \n **(n = {n})**', 
    stat_5 = '**None** \n **(n = {n})**'
  ) %>%
  bold_labels()%>%
  remove_row_type(variable = oatcurrentmed.f, 
                  type = "level", level_value = "None")%>%
  remove_row_type(variable = clinic.attend.factor, 
                  type = "level", level_value = "0")%>%
  remove_row_type(variable = lastdosesite, 
                  type = "level", level_value = "Not prescribed")

pts_oatfull_stratified.kable  <- pts_oatfull_stratified  %>%
   gtsummary::as_kable_extra(
    format = "html",
    booktabs = TRUE,
    longtable = TRUE,
    linesep = "", 
    caption="Final model including crude odds ratios (cOR) and adjusted odds ratios (aOR)")%>%
  kableExtra::kable_styling(
      position = "left",
      latex_options = c("striped", "repeat_header"),
      stripe_color = "gray!15"
    )

```

```{r, echo = FALSE, include = TRUE}
#| label: tbl-s2

pts_oatfull_stratified.kable
```

### Table S3

```{r, message=F}
p <- p %>%
mutate(prefer.factor = fct_relevel(prefer.factor,"Methadone", "Buprenorphine"))

pts_oat_stratified <-  
  p %>%
  filter(lastdosesite != "Not prescribed")%>%
  filter(prefertreat.yn == "Prefers treatment")%>%
  filter(prefer.factor == "Methadone" | prefer.factor == "Buprenorphine")%>%
  filter(pref_oat == "Methadone" | prefer.factor == "Buprenorphine")%>%
  filter(oat.yn.f == "Yes")%>%
  tbl_summary(by = prefer.factor, include = c(age, agegroup, 
                                              gender.mf, edu.factor,
                                              income.factor.yn, homeless.factor.yn,         
                                              prison.factor, chronicpain.factor.yn,
                                              heroin.month.factor,  
                                              nonmethadone.month.factor,
                                              nonbupe.month.factor, 
                                              otheropi.month.factor, 
                                              cocaine.month.factor, meth.month.factor, 
                                              benzo.month.factor,
                                              methadoneever.yn, bupeever.factor,
                                              currentmed,
                                              
                                              usedrugs.oat, paytx.yn.f, 
                                              lastdosesite,clinic.attend.factor,  
                                               kmdose, timedose.factor,
                                              prefer.factor 
  ),
  # type = all_categorical() ~ "categorical",
  label = 
    list(age ~ "Age",
         agegroup ~ "Age group",
         gender.mf ~ "Gender",
         usedrugs.oat ~ "Drugs used while on OAT",
         methadoneever.yn ~ "Ever received OAT with methadone", 
         bupeever.factor ~ "Ever received OAT with buprenorphine",
         timedose.factor ~ "Travel time to dosing site",
         clinic.attend.factor ~ "Frequency of OAT dose collection",
         kmdose ~ "Travel distance to OAT collection site (km)", 
         lastdosesite ~ "Site last dose collected",
         otheropi.month.factor ~ "Non-prescribed pharmaceutical opioid use",
         currentmed ~ "Current OAT medication"), 
         # current_methadone ~ "Currently receiving OAT with methadone", 
         # current_buprenorphine ~ "Currently receiving OAT with buprenorphine"),
  type = all_categorical()~"categorical",
  missing = "no",
  percent = "row",
  statistic =(all_continuous()  ~ "{median} ({p25} - {p75})"),
  digits = list(all_categorical() ~ c(0)))%>%
  add_stat_label()%>%
  add_overall(statistic = list(all_continuous()  ~ "{median} ({p25} - {p75})",
                               all_categorical() ~ "{n}")) %>% 
  modify_footnote(update = everything() ~ NA, abbreviation = FALSE) %>%
  add_n()%>%
  modify_header(
    stat_0 = '**Overall** \n **(n = {n})**',
    stat_1 = '**Methadone** \n **(n = {n})**',
    stat_2 = '**Buprenorphine** \n **(n = {n})**'
  ) %>%
  bold_labels()%>%
  # remove_row_type(variable = oatcurrentmed.f, 
  #                 type = "level", level_value = "None")%>%
  remove_row_type(variable = clinic.attend.factor, 
                type = "level", level_value = "0")%>%
  remove_row_type(variable = lastdosesite, 
                  type = "level", level_value = "Not prescribed")
```

```{r include = FALSE}
pts_oat_stratified.kable <- pts_oat_stratified %>% 
   gtsummary::as_kable_extra(
    format = "html",
    booktabs = TRUE,
    longtable = TRUE,
    linesep = "", 
    caption="Demographic and behavioural characteristics of people currently receiving OAT stratified by preference for methadone or buprenorphine")%>%
  kableExtra::kable_styling(
      position = "left",
      latex_options = c("striped", "repeat_header"),
      stripe_color = "gray!15"
    )
```

```{r echo=FALSE, include = F}
pts_oat_stratified.kable
```

```{r}

p <- p %>%
  mutate(prefer.factor = fct_relevel(prefer.factor, "Buprenorphine", "Methadone"))
```

```{r}

 oat_cor <-
   p %>%
  filter(lastdosesite != "Not prescribed")%>%
  filter(prefertreat.yn == "Prefers treatment")%>%
  filter(prefer.factor == "Methadone" | prefer.factor == "Buprenorphine")%>%
  filter(pref_oat == "Methadone" | prefer.factor == "Buprenorphine")%>%
  filter(oat.yn.f == "Yes")%>%
  dplyr::select(age, gender.mf, nonmethadone.month.factor, 
                nonbupe.month.factor,heroin.month.factor,
                methadoneever.yn, bupeever.factor, 
                currentmed,lastdosesite,
                usedrugs.oat, paytx.yn.f,
                clinic.attend.factor, kmdose,
                timedose.factor, prefer.factor) %>%
  tbl_uvregression(
    method = glm,
    y = prefer.factor, 
    label = list(age ~ "Age",
         # agegroup ~ "Age group",
         gender.mf ~ "Gender",
         usedrugs.oat ~ "Drugs used while on OAT",
         methadoneever.yn ~ "Ever received OAT with methadone", 
         bupeever.factor ~ "Ever received OAT with buprenorphine",
         timedose.factor ~ "Travel time to dosing site",
         clinic.attend.factor ~ "Frequency of OAT dose collection",
         kmdose ~ "Travel distance to OAT collection site (km)", 
         lastdosesite ~ "Site last dose collected", 
         currentmed ~ "Current OAT medication"),
                 # current_methadone ~ "Currently receiving OAT with methadone", 
                 # current_buprenorphine ~ "Currently receiving OAT with buprenorphine"),
    method.args = list(family = binomial),
    exponentiate = TRUE,
    hide_n = TRUE,
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
   modify_header(
     label = "**Variable**",
     estimate = '**cOR**',
     ci = '**95% CI**',
     p.value = '**p-value**'
   ) %>%
   modify_footnote(update = everything() ~ NA, abbreviation = TRUE) %>%
   modify_table_styling(
     column = estimate,
     rows = !is.na(estimate),
     cols_merge_pattern = "{estimate} ({conf.low} - {conf.high})"
   ) %>%
   modify_header(estimate = "**cOR (95% CI)**", 
                 all_stat_cols() ~ "**{level}**, N = {n} ({style_percent(p)}%)") %>%
   modify_column_hide(c(ci)) %>% 
   # bold_p()%>% # bold p-values under a given threshold (default 0.05)
   #bold_p(t = 0.10, q = TRUE) %>% # now bold q-values under the threshold of 0.10
   bold_labels()%>%
  remove_row_type(variable = clinic.attend.factor, 
                type = "level", level_value = "0")%>%
  remove_row_type(variable = lastdosesite, 
                  type = "level", level_value = "Not prescribed")
  
```

```{r include=TRUE, echo=FALSE}

oat_cor.kable <- oat_cor %>% 
   gtsummary::as_kable_extra(
    format = "html",
    booktabs = TRUE,
    longtable = TRUE,
    linesep = "", 
    caption="Results of a univariate logistic regression with crude odds ratios and 95% confidence interval")%>%
  kableExtra::kable_styling(
      position = "left",
      latex_options = c("striped", "repeat_header"),
      stripe_color = "gray!15"
    )

```

```{r echo=FALSE, include = FALSE}
oat_cor.kable
```

```{r}
p <- p %>%
  mutate(prefer.factor = fct_relevel(prefer.factor, "Buprenorphine", "Methadone"))


oatcurrent_cor <-
  p %>%
  filter(lastdosesite != "Not prescribed")%>%
  filter(prefertreat.yn == "Prefers treatment")%>%
  filter(prefer.factor == "Methadone" | prefer.factor == "Buprenorphine")%>%
  filter(pref_oat == "Methadone" | prefer.factor == "Buprenorphine")%>%
  filter(oat.yn.f == "Yes")%>%
  dplyr::select(age, gender.mf,edu.factor, income.factor.yn, homeless.factor.yn,  
                prison.factor, chronicpain.factor.yn, heroin.month.factor, 
                nonmethadone.month.factor,
                nonbupe.month.factor, otheropi.month.factor, 
                cocaine.month.factor, meth.month.factor, benzo.month.factor,
                currentmed,
                usedrugs.oat, paytx.yn.f,
                clinic.attend.factor, kmdose,
                timedose.factor, prefer.factor, lastdosesite) %>%
  tbl_uvregression(
    method = glm,
    y = prefer.factor, 
    label = list(age ~ "Age",
                 gender.mf ~ "Gender",
                 otheropi.month.factor ~ "Non-prescribed pharmaceutical opioid use",
                 usedrugs.oat ~ "Drugs used while on OAT",
                 # methadoneever.yn ~ "Ever received OAT with methadone",
                 # bupeever.factor ~ "Ever received OAT with buprenorphine", 
                 # gender.mf ~ "Gender", 
                 clinic.attend.factor ~ "Frequency of OAT dose collection", 
                 kmdose ~ "Travel distance to OAT collection site (km)", 
                 timedose.factor ~ "Travel time to dosing site",
                 lastdosesite ~ "Site last dose collected",
                 currentmed ~ "Current OAT medication"),
    method.args = list(family = binomial),
    exponentiate = TRUE,
    hide_n = TRUE,
    pvalue_fun = function(x) style_pvalue(x, digits = 3)
  ) %>%
  modify_header(
    label = "**Variable**",
    estimate = '**cOR**',
    ci = '**95% CI**',
    p.value = '**p-value**'
  ) %>%
  modify_footnote(update = everything() ~ NA, abbreviation = TRUE) %>%
  modify_table_styling(
    column = estimate,
    rows = !is.na(estimate),
    cols_merge_pattern = "{estimate} ({conf.low} - {conf.high})"
  ) %>%
  modify_header(estimate = "**cOR (95% CI)**", 
                all_stat_cols() ~ "**{level}**, N = {n} ({style_percent(p)}%)") %>%
  modify_column_hide(c(ci)) %>% 
  # add_n()%>%
  # bold_p()%>% # bold p-values under a given threshold (default 0.05)
  #bold_p(t = 0.10, q = TRUE) %>% # now bold q-values under the threshold of 0.10
  bold_labels()%>%
  remove_row_type(variable = clinic.attend.factor, 
                type = "level", level_value = "0")%>%
  remove_row_type(variable = lastdosesite, 
                  type = "level", level_value = "Not prescribed")%>%
 modify_table_styling(label = "**Overall (n = {n})**")
 
 oatcurrent_cor
```

<!-- #### Variable selection -->

<!-- In univariate regression, variables that return a p-value \< 0.20 are -->

<!-- purposefully selected for inclusion in the final model. -->

<!-- The following variables had a p-value \< 0.05 in the univariate -->

<!-- regression: -->

```{r}
# aOR_var_oat <- p %>%
# 
#   dplyr::select(age, gender.mf,  homeless.factor.yn, heroin.month.factor,
#                 nonmethadone.month.factor,
#                  currentmed,paytx.yn.f, lastdosesite,
#                 doselocation.factor, clinic.attend, timedose.factor)
```

```{r}
# aOR_var_oat <- map_df(aOR_variables_var, function(x) attributes(x)$label) %>% 
#   gather(key = Code, value = Label)
```

```{r echo = FALSE, include = TRUE}
## View the codebook
# library(kableExtra)
# aOR_var_oat %>%
#       kable(caption="Codebook of variables selected for the unadjusted odds ratios from a multivariable logistic regression among participants currently receiving OAT", col.names = c("Variable", "Description"),  booktabs = TRUE) %>%
#   kable_styling(bootstrap_options = "striped", row_label_position = c(2, 5),  full_width = TRUE, position = "center", fixed_thead = list(enabled = T, background = "anycolor")) 
```

```{r}
oat_model_final <- glm(prefer.factor ~ age + gender.mf + heroin.month.factor +  nonmethadone.month.factor + currentmed + paytx.yn.f + lastdosesite+  
                         kmdose + clinic.attend.factor
                       , data=p, family=binomial)

```

```{r, message=F, warning=F}
oat_mod_final <- tbl_regression(oat_model_final, exponentiate = TRUE,  
                                label = 
                                  list(age ~ "Age",
        
         gender.mf ~ "Gender",
         # usedrugs.oat ~ "Drugs used while on OAT",
         # methadoneever.yn ~ "Ever received OAT with methadone", 
         # bupeever.factor ~ "Ever received OAT with buprenorphine",
         # timedose.factor ~ "Travel time to dosing site",
         clinic.attend.factor ~ "Frequency of OAT dose collection",
         kmdose ~ "Travel distance to OAT collection site (km)", 
         lastdosesite ~ "Site last dose collected", 
         currentmed ~ "Current OAT medication"),
                                add_estimate_to_reference_rows = FALSE,
                                # show_single_row = c(age, gender.mf, heroin.month.factor),
                                pvalue_fun = function(x) style_pvalue(x, digits = 3))%>%
  # pvalue_fun = ~style_sigfig(., digits = 4)                              )%>%
  modify_header(
    label = '**Variable**',
    estimate = '**aOR**',
    ci = '**95% CI**',
    p.value = '**p-value**'
  ) %>%
  modify_footnote(update = everything() ~ NA, abbreviation = TRUE) %>%
  modify_table_styling(
    column = estimate,
    rows = !is.na(estimate),
    cols_merge_pattern = "{estimate} ({conf.low} - {conf.high})"
  ) %>%
  modify_header(estimate ~ "**aOR (95% CI)**") %>%
  modify_column_hide(c(ci)) %>% 
  bold_labels() %>%
  modify_footnote(everything() ~ NA, abbreviation = TRUE)%>%
   remove_row_type(variable = clinic.attend.factor, 
                type = "level", level_value = "0")%>%
  remove_row_type(variable = lastdosesite, 
                  type = "level", level_value = "Not prescribed")


p <- p%>% 
  filter(clinic.attend.factor != "0")%>%
  filter(lastdosesite != "Not prescribed")
  
```

```{r include = FALSE, message=F}
oat_mod_final.kable <- oat_mod_final%>% 
   gtsummary::as_kable_extra(
    format = "html",
    booktabs = TRUE,
    longtable = TRUE,
    linesep = "", 
    caption="Results of a multivariable logistic regression with adjusted odds ratios and 95% confidence interval among participants currently receiving OAT")%>%
  kableExtra::kable_styling(
      position = "left",
      latex_options = c("striped", "repeat_header"),
      stripe_color = "gray!15"
    )
```

```{r echo = FALSE, include=FALSE}
oat_mod_final.kable
```

```{r}
table_merged_oat <-
  tbl_merge(
    tbls = list(pts_oat_stratified, oatcurrent_cor,oat_mod_final),
    tab_spanner = c("** **", "**Unadjusted model**", "**Adjusted model**")) %>%
  modify_header(label = "**Variable**") %>% # update the column header
  modify_footnote(everything() ~ NA)

```

```{r echo=FALSE, include=F}
table_merged_oat.kable <- table_merged_oat %>% 
   gtsummary::as_kable_extra(
    format = "html",
    booktabs = TRUE,
    longtable = TRUE,
    linesep = "", 
    caption="Demographic and behavioral characteristics stratified by OAT medication preference and sesults of a multivariable logistic regression with adjusted odds ratios and 95% confidence interval among participants currently receiving OAT")%>%
  kableExtra::kable_styling(
      position = "left",
      latex_options = c("striped", "repeat_header"),
      stripe_color = "gray!15"
    )
#       scroll_box(
#   height = "100%",
#   width = "100%",
#   box_css = "border: 1px solid #ddd; padding: 5px; ",
#   extra_css = NULL,
#   fixed_thead = TRUE
# )
```

```{r echo = FALSE, include = TRUE}
table_merged_oat.kable
```
